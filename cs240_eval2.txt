CREATE TABLE SALES_PEOPLE (
    S_NUM INT PRIMARY KEY,
    S_NAME VARCHAR(50),
    CITY VARCHAR(50),
    COMM DECIMAL(4,2)
);

CREATE TABLE CUSTOMERS (
    C_NUM INT PRIMARY KEY,
    C_NAME VARCHAR(50),
    CITY VARCHAR(50),
    RATING INT,
    S_NUM INT,
    FOREIGN KEY (S_NUM) REFERENCES SALES_PEOPLE(S_NUM)
);

CREATE TABLE ORDERS (
    O_NUM INT PRIMARY KEY,
    AMT INT,
    ORDER_DATE DATE,
    C_NUM INT,
    S_NUM INT,
    FOREIGN KEY (C_NUM) REFERENCES CUSTOMERS(C_NUM),
    FOREIGN KEY (S_NUM) REFERENCES SALES_PEOPLE(S_NUM)  
);

INSERT INTO SALES_PEOPLE VALUES
(1001, 'Jessica', 'London', 0.12),
(1002, 'Robert', 'SanJose', 0.13),
(1003, 'Alex', 'London', 0.11),
(1004, 'Mathew', 'Barcelona', 0.15),
(1007, 'Rihana', 'New York', 0.10);

INSERT INTO CUSTOMERS VALUES
(2001, 'Hoffman', 'London', 100, 1001),
(2002, 'Tiffiany', 'Rome', 200, 1003),
(2003, 'Liu', 'SanJose', 200, 1002),
(2004, 'Thomas', 'Berlin', 300, 1002),
(2006, 'Clara', 'London', 100, 1001),
(2008, 'Ariana', 'SanJose', 300, 1007),
(2007, 'Duke', 'Rome', 100, 1004);

INSERT INTO ORDERS VALUES
(3001, 1860, '2024-01-03', 2008, 1007),
(3003, 7670, '2022-07-03', 2001, 1001),
(3002, 0, '2024-01-03', 2007, 1004),
(3005, 5160, '2023-10-03', 2003, 1007),
(3006, 1095, '2023-10-03', 2008, 1007),
(3009, NULL, '2024-01-04', 2002, 1007),
(3007, 5570, '2024-01-04', 2004, 1007),
(3008, 4723, '2023-10-05', 2006, 1007),
(3010, NULL, '2022-07-06', 2004, 1007),
(3011, 1095, '2022-07-03', 2006, 1007);

// 1
SELECT S.*, C.RATING
FROM SALES_PEOPLE S
LEFT JOIN CUSTOMERS C ON S.S_NUM = C.S_NUM
ORDER BY S.CITY, C.RATING;

// 2
SELECT COUNT(*) FROM ORDERS
WHERE ORDER_DATE LIKE '%-10-03';

// 3
SELECT C.C_NUM, C.C_NAME, MIN(O.AMT)
FROM CUSTOMERS C
LEFT JOIN ORDERS O ON C.C_NUM = O.C_NUM
WHERE O.AMT IS NOT NULL
AND O.AMT != 0
GROUP BY C.C_NUM, C.C_NAME
ORDER BY C.C_NUM;

// 4
SELECT ORDER_DATE, COUNT(DISTINCT S_NUM)
FROM ORDERS
GROUP BY ORDER_DATE
ORDER BY ORDER_DATE;

// 5
SELECT RATING, C_NAME, C_NUM
FROM CUSTOMERS
ORDER BY RATING DESC;

// 6
SELECT DISTINCT C.C_NUM, C.C_NAME
FROM ORDERS O
LEFT JOIN CUSTOMERS C ON O.C_NUM = C.C_NUM
WHERE AMT IS NOT NULL
AND AMT > 5000
AND ORDER_DATE LIKE '2024-%';

// 7
SELECT C.C_NUM, C.C_NAME
FROM CUSTOMERS C
LEFT JOIN ORDERS O ON C.C_NUM = O.C_NUM
WHERE O.O_NUM IS NULL;

// 8
SELECT S.S_NUM, S.S_NAME, SUM(O.AMT)
FROM SALES_PEOPLE S
LEFT JOIN ORDERS O ON S.S_NUM = O.S_NUM
WHERE O.AMT IS NOT NULL
GROUP BY S.S_NUM, S.S_NAME
HAVING SUM(O.AMT) > (
    SELECT MAX(AMT) FROM ORDERS 
    WHERE AMT IS NOT NULL
);